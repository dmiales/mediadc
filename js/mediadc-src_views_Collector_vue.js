"use strict";(self.webpackChunkmediadc=self.webpackChunkmediadc||[]).push([["src_views_Collector_vue"],{14434:(t,e,n)=>{n.d(e,{A:()=>o});var i=n(71354),s=n.n(i),a=n(76314),r=n.n(a)()(s());r.push([t.id,"\n.list-enter-active[data-v-036192ef],\n.list-leave-active[data-v-036192ef] {\n\ttransition: all 1s ease;\n}\n.list-enter-from[data-v-036192ef],\n.list-leave-to[data-v-036192ef] {\n\topacity: 0;\n\ttransform: translateY(30px);\n}\n.tasks-list[data-v-036192ef] {\n\tpadding: 20px;\n\tbackground-color: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 482px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n.task-row[data-v-036192ef] {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n\tborder-radius: var(--border-radius-pill);\n\tborder-color: var(--color-border-dark);\n}\n.task-row[data-v-036192ef]:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n@media (max-width: 540px) {\n.task-row[data-v-036192ef], .task-row a[data-v-036192ef] {\n\t\tflex-direction: column;\n\t\tpadding: 5px;\n}\n.delete-task-button[data-v-036192ef] {\n\t\tvisibility: visible;\n}\n}\n.empty-tasks-list[data-v-036192ef] {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksList.vue"],names:[],mappings:";AAyFA;;CAEA,uBAAA;AACA;AAEA;;CAEA,UAAA;CACA,2BAAA;AACA;AAEA;CACA,aAAA;CACA,oDAAA;CACA,yCAAA;CACA,WAAA;CACA,YAAA;CACA,gBAAA;CACA,iBAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,mBAAA;CACA,0BAAA;CACA,wCAAA;CACA,sCAAA;AACA;AAEA;CACA,yCAAA;AACA;AAEA;AACA;EACA,sBAAA;EACA,YAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;AAEA;CACA,aAAA;CACA,WAAA;CACA,WAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,sBAAA;CACA,sBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"tasks-list\">\n\t\t<h2>{{ t('mediadc', 'Recent Tasks') }}</h2>\n\t\t<div v-if=\"tasks.length > 0\">\n\t\t\t<transition-group name=\"list\" tag=\"ul\">\n\t\t\t\t<TasksListItem v-for=\"task in tasks\"\n\t\t\t\t\t:key=\"task.id\"\n\t\t\t\t\tclass=\"task-row\"\n\t\t\t\t\t:task=\"task\" />\n\t\t\t</transition-group>\n\t\t</div>\n\t\t<div v-else class=\"empty-tasks-list\">\n\t\t\t<NcEmptyContent style=\"margin-top: 5vh;\"\n\t\t\t\t:name=\"t('mediadc', 'No tasks yet')\"\n\t\t\t\t:description=\"t('mediadc', 'Create a new one!')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ClipboardListOutline />\n\t\t\t\t</template>\n\t\t\t</NcEmptyContent>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport { NcEmptyContent } from '@nextcloud/vue'\nimport ClipboardListOutline from 'vue-material-design-icons/ClipboardListOutline.vue'\n\nimport Formats from '../../mixins/Formats.js'\nimport TasksListItem from './TasksListItem.vue'\n\nexport default {\n\tname: 'TasksList',\n\tcomponents: {\n\t\tTasksListItem,\n\t\tNcEmptyContent,\n\t\tClipboardListOutline,\n\t},\n\tmixins: [Formats],\n\tdata() {\n\t\treturn {\n\t\t\ttasksUpdater: null,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.tasksUpdater = setInterval(() => this.getTasks(true), 5000)\n\t},\n\tbeforeDestroy() {\n\t\tclearInterval(this.tasksUpdater)\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style scoped>\n.list-enter-active,\n.list-leave-active {\n\ttransition: all 1s ease;\n}\n\n.list-enter-from,\n.list-leave-to {\n\topacity: 0;\n\ttransform: translateY(30px);\n}\n\n.tasks-list {\n\tpadding: 20px;\n\tbackground-color: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 482px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n\n.task-row {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n\tborder-radius: var(--border-radius-pill);\n\tborder-color: var(--color-border-dark);\n}\n\n.task-row:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n\n@media (max-width: 540px) {\n\t.task-row, .task-row a {\n\t\tflex-direction: column;\n\t\tpadding: 5px;\n\t}\n\t.delete-task-button {\n\t\tvisibility: visible;\n\t}\n}\n\n.empty-tasks-list {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n</style>\n"],sourceRoot:""}]);const o=r},91806:(t,e,n)=>{n.d(e,{A:()=>o});var i=n(71354),s=n.n(i),a=n(76314),r=n.n(a)()(s());r.push([t.id,"\n.list-item {\n\tmargin: 0 !important;\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksListItem.vue"],names:[],mappings:";AAqHA;CACA,oBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<NcListItem :name=\"listItemTitle\"\n\t\t:bold=\"true\"\n\t\t:force-display-actions=\"true\"\n\t\t:to=\"{ name: 'collectorDetails', params: { taskId: task.id } }\"\n\t\tclass=\"task-list-item\">\n\t\t<template #icon>\n\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t</template>\n\t\t<template #subname>\n\t\t\t{{ listItemDetails }}\n\t\t\t<NcProgressBar :value=\"Math.round((task.files_scanned / task.files_total) * 100)\"\n\t\t\t\tsize=\"small\"\n\t\t\t\t:error=\"getStatusBadge(task) === 'error'\" />\n\t\t</template>\n\t\t<template #actions>\n\t\t\t<NcActionButton icon=\"icon-history\" :close-after-click=\"true\" @click=\"restartTask(task)\">\n\t\t\t\t{{ getStatusBadge(task) === 'duplicated' ? t('mediadc', 'Start') : t('mediadc', 'Restart') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-pause\" :close-after-click=\"true\" @click=\"terminateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Stop') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton v-tooltip=\"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}\"\n\t\t\t\t:close-after-click=\"true\"\n\t\t\t\t@click=\"duplicateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Duplicate') }}\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ContentCopy :size=\"16\" />\n\t\t\t\t</template>\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-delete\" :close-after-click=\"true\" @click=\"deleteTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Delete') }}\n\t\t\t</NcActionButton>\n\t\t</template>\n\t</NcListItem>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport {\n\tNcActionButton,\n\tNcProgressBar,\n\tNcListItem,\n} from '@nextcloud/vue'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\n\nimport Formats from '../../mixins/Formats.js'\n\nexport default {\n\tname: 'TasksListItem',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tContentCopy,\n\t\tNcListItem,\n\t\tNcProgressBar,\n\t},\n\tmixins: [Formats],\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t\tlistItemTitle() {\n\t\t\tconst taskName = this.task.name !== '' && this.task.name !== null ? this.task.name + ' - ' : ''\n\t\t\treturn `${taskName}${this.parseTargetMtype(this.task)}\n\t\t\t\t${this.task.files_scanned !== this.task.files_total ? this.task.files_scanned + '/' : ''}${this.task.files_total} ${this.n('mediadc', 'file', 'files', this.task.files_total)}\n\t\t\t\t(${this.formatBytes(Number(this.task.files_total_size))})`\n\t\t},\n\t\tlistItemDetails() {\n\t\t\treturn `${this.parseUnixTimestamp(this.task.created_time)}\n\t\t\t\t${Number(this.task.finished_time) > 0 ? ' - ' + this.parseUnixTimestamp(this.task.finished_time) : ''}`\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t\t'getSettings',\n\t\t\t'deleteTask',\n\t\t\t'duplicateTask',\n\t\t\t'terminateTask',\n\t\t\t'restartTask',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style>\n.list-item {\n\tmargin: 0 !important;\n}\n</style>\n\n<style scoped>\n.task-list-item {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n\n@media (max-width: 540px) {\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},49394:(t,e,n)=>{n.d(e,{A:()=>o});var i=n(71354),s=n.n(i),a=n(76314),r=n.n(a)()(s());r.push([t.id,"\n.task-list-item[data-v-6c910423] {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n@media (max-width: 540px) {\n.badge[data-v-6c910423] {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n}\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksListItem.vue"],names:[],mappings:";AA2HA;CACA,yBAAA;CACA,8CAAA;CACA,mBAAA;AACA;AAEA;AACA;EACA,eAAA;EACA,mBAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<NcListItem :name=\"listItemTitle\"\n\t\t:bold=\"true\"\n\t\t:force-display-actions=\"true\"\n\t\t:to=\"{ name: 'collectorDetails', params: { taskId: task.id } }\"\n\t\tclass=\"task-list-item\">\n\t\t<template #icon>\n\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t</template>\n\t\t<template #subname>\n\t\t\t{{ listItemDetails }}\n\t\t\t<NcProgressBar :value=\"Math.round((task.files_scanned / task.files_total) * 100)\"\n\t\t\t\tsize=\"small\"\n\t\t\t\t:error=\"getStatusBadge(task) === 'error'\" />\n\t\t</template>\n\t\t<template #actions>\n\t\t\t<NcActionButton icon=\"icon-history\" :close-after-click=\"true\" @click=\"restartTask(task)\">\n\t\t\t\t{{ getStatusBadge(task) === 'duplicated' ? t('mediadc', 'Start') : t('mediadc', 'Restart') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-pause\" :close-after-click=\"true\" @click=\"terminateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Stop') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton v-tooltip=\"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}\"\n\t\t\t\t:close-after-click=\"true\"\n\t\t\t\t@click=\"duplicateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Duplicate') }}\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ContentCopy :size=\"16\" />\n\t\t\t\t</template>\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-delete\" :close-after-click=\"true\" @click=\"deleteTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Delete') }}\n\t\t\t</NcActionButton>\n\t\t</template>\n\t</NcListItem>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport {\n\tNcActionButton,\n\tNcProgressBar,\n\tNcListItem,\n} from '@nextcloud/vue'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\n\nimport Formats from '../../mixins/Formats.js'\n\nexport default {\n\tname: 'TasksListItem',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tContentCopy,\n\t\tNcListItem,\n\t\tNcProgressBar,\n\t},\n\tmixins: [Formats],\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t\tlistItemTitle() {\n\t\t\tconst taskName = this.task.name !== '' && this.task.name !== null ? this.task.name + ' - ' : ''\n\t\t\treturn `${taskName}${this.parseTargetMtype(this.task)}\n\t\t\t\t${this.task.files_scanned !== this.task.files_total ? this.task.files_scanned + '/' : ''}${this.task.files_total} ${this.n('mediadc', 'file', 'files', this.task.files_total)}\n\t\t\t\t(${this.formatBytes(Number(this.task.files_total_size))})`\n\t\t},\n\t\tlistItemDetails() {\n\t\t\treturn `${this.parseUnixTimestamp(this.task.created_time)}\n\t\t\t\t${Number(this.task.finished_time) > 0 ? ' - ' + this.parseUnixTimestamp(this.task.finished_time) : ''}`\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t\t'getSettings',\n\t\t\t'deleteTask',\n\t\t\t'duplicateTask',\n\t\t\t'terminateTask',\n\t\t\t'restartTask',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style>\n.list-item {\n\tmargin: 0 !important;\n}\n</style>\n\n<style scoped>\n.task-list-item {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n\n@media (max-width: 540px) {\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},65390:(t,e,n)=>{n.d(e,{A:()=>o});var i=n(71354),s=n.n(i),a=n(76314),r=n.n(a)()(s());r.push([t.id,"\n.new-task-block[data-v-0e7940d3] {\n\tborder: 1px solid var(--color-border-dark);\n\tborder-radius: var(--border-radius-large);\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px 20px 10px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\nbody[data-theme-dark] .new-task-block[data-v-0e7940d3] {\n\tborder-color: var(--color-border-dark);\n}\n@media (max-width: 767px) {\n.selection-container[data-v-0e7940d3] {\n\t\tflex-wrap: wrap;\n}\n}\n.create-task-actions[data-v-0e7940d3] {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 5px;\n\tpadding: 0 10px;\n}\n@media (max-width: 480px) {\n.create-task-actions[data-v-0e7940d3] {\n\t\tflex-direction: column;\n}\n.create-task-actions button[data-v-0e7940d3] {\n\t\tmargin-bottom: 10px;\n}\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksNew.vue"],names:[],mappings:";AA8YA;CACA,0CAAA;CACA,yCAAA;CACA,wCAAA;CACA,uBAAA;CACA,YAAA;CACA,WAAA;CACA,gBAAA;AACA;AAEA;CACA,sCAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,eAAA;CACA,eAAA;AACA;AAEA;AACA;EACA,sBAAA;AACA;AAEA;EACA,mBAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"new-task-block\">\n\t\t<h2>{{ t('mediadc', 'Create a new Task') }}</h2>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block target-directories-block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Target directories') }}</h3>\n\t\t\t\t<div v-if=\"targetDirectoriesIds.length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in targetDirectoriesIds\" :key=\"fileid\" class=\"selected-target-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span :title=\"targetDirectoriesPaths[fileid]\"\n\t\t\t\t\t\t\t\tstyle=\"overflow-y: scroll; white-space: nowrap;\">\n\t\t\t\t\t\t\t\t{{ targetDirectoriesPaths[fileid] }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected target directory')\"\n\t\t\t\t\t\t\t\t@click=\"removeTargetDirectory(fileid)\">\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<NcButton :aria-label=\"t('mediadc', 'Select target directory')\"\n\t\t\t\t\t@click=\"openDirectoriesExplorer\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Exclude directories') }}</h3>\n\t\t\t\t<div v-if=\"excludeDirectoriesPaths.length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in Object.keys(excludeFileIds)\" :key=\"fileid\" class=\"selected-excluded-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span :title=\"excludeFileIds[fileid]\"\n\t\t\t\t\t\t\t\tstyle=\"overflow-y: scroll; white-space: nowrap;\">\n\t\t\t\t\t\t\t\t{{ excludeFileIds[fileid] }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected exclude directory')\"\n\t\t\t\t\t\t\t\t@click=\"removeExcludeDirectory(fileid)\">\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<NcButton :aria-label=\"t('mediadc', 'Select exclude directory')\"\n\t\t\t\t\t@click=\"openExcludeExplorer\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Custom exclude mask') }}</h3>\n\t\t\t\t<div v-if=\"customExcludeList.length > 0\" class=\"custom-masks-list\">\n\t\t\t\t\t<div v-for=\"(mask, index) in customExcludeList\" :key=\"index\" class=\"custom-mask\">\n\t\t\t\t\t\t<span>{{ mask }}</span>\n\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected custom exclude mask')\"\n\t\t\t\t\t\t\t@click=\"deleteCustomMask(mask)\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not added') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"addingCustomMask\" style=\"display: flex; align-items: center;\">\n\t\t\t\t\t<input id=\"custom-exclude-mask\"\n\t\t\t\t\t\tref=\"customExcludeMask\"\n\t\t\t\t\t\tv-model=\"customExcludeMask\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t@keyup.enter=\"addCustomMask\"\n\t\t\t\t\t\t@keyup.esc=\"cancelAddingCustomMask\">\n\t\t\t\t\t<NcButton v-tooltip=\"t('mediadc', 'Confirm')\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Confirm adding of the custom exclude mask')\"\n\t\t\t\t\t\t@click=\"addCustomMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<span class=\"icon-checkmark\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\t\t\t\t\t<NcButton v-tooltip=\"t('mediadc', 'Decline')\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Cancel adding of the custom exclude mask')\"\n\t\t\t\t\t\t@click=\"cancelAddingCustomMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<span class=\"icon-close\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"display: flex; align-items: center; margin: 20px 0;\">\n\t\t\t\t\t<NcButton :aria-label=\"t('mediadc', 'Add custom exclude mask')\"\n\t\t\t\t\t\t@click=\"addNewMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t\t{{ t('mediadc', 'Add mask') }}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Target Mime Type') }}\n\t\t\t\t</h3>\n\t\t\t\t<select id=\"target_mtype\"\n\t\t\t\t\tv-model=\"targetMimeType\"\n\t\t\t\t\tname=\"target_mtype\">\n\t\t\t\t\t<option :value=\"0\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"1\">\n\t\t\t\t\t\t{{ t('mediadc', 'Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"2\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos and Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t</select>\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Similarity threshold') }}\n\t\t\t\t</h3>\n\t\t\t\t<input v-model=\"similarity_threshold\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tmin=\"50\"\n\t\t\t\t\tmax=\"100\"\n\t\t\t\t\tstyle=\"margin: 0 0 10px;\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"create-task-actions\">\n\t\t\t<NcButton :aria-label=\"t('mediadc', 'Create and Run new Task')\"\n\t\t\t\t:disabled=\"runningTask || Object.keys(targetDirectoriesPaths).length === 0\"\n\t\t\t\t@click=\"runCollectorTask\">\n\t\t\t\t<template #default>\n\t\t\t\t\t{{ t('mediadc', 'Run new Task') }}\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"runningTask\" #icon>\n\t\t\t\t\t<span class=\"icon-loading-small\" />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\t\t\t<input v-model=\"taskName\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t:placeholder=\"t('mediadc', 'Task name')\">\n\t\t\t<NcCheckboxRadioSwitch v-tooltip=\"t('mediadc', 'Send notification on task finish')\"\n\t\t\t\t:checked.sync=\"finishNotification\">\n\t\t\t\t{{ t('mediadc', 'Finish notification') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getFilePickerBuilder, showWarning, showSuccess, showError } from '@nextcloud/dialogs'\nimport { mapActions, mapGetters } from 'vuex'\n\nimport { requestFileInfo, getFileId } from '../../utils/files.js'\n\nimport { NcButton, NcCheckboxRadioSwitch } from '@nextcloud/vue'\nimport PlusThick from 'vue-material-design-icons/PlusThick.vue'\n\nexport default {\n\tname: 'TasksNew',\n\tcomponents: {\n\t\tNcButton,\n\t\tNcCheckboxRadioSwitch,\n\t\tPlusThick,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\ttargetDirectoriesPaths: {},\n\t\t\ttargetDirectoriesIds: [],\n\t\t\texcludeDirectoriesPaths: [],\n\t\t\texcludeFileIds: {},\n\t\t\ttargetMimeType: 0,\n\t\t\tsimilarity_threshold: 90,\n\t\t\tcustomExcludeList: [],\n\t\t\tcustomExcludeMask: '',\n\t\t\taddingCustomMask: false,\n\t\t\trunningTask: false,\n\t\t\tfinishNotification: true,\n\t\t\ttaskName: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'settings',\n\t\t\t'settingByName',\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t: 90\n\t},\n\tmethods: {\n\t\t...mapActions(['runTask', 'getTasks']),\n\t\tgetDirectoriesPicker(title) {\n\t\t\treturn getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.addMimeTypeFilter('httpd/unix-directory')\n\t\t\t\t.setType(1)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.build()\n\t\t},\n\t\topenDirectoriesExplorer() {\n\t\t\tthis.getDirectoriesPicker(this.t('mediadc', 'Choose target directory')).pick().then(dir => {\n\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = dir\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\trequestFileInfo('/').then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = '/'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\topenExcludeExplorer() {\n\t\t\tthis.getDirectoriesPicker(this.t('mediadc', 'Choose directory to exclude')).pick().then(dir => {\n\t\t\t\tif (Object.values(this.excludeFileIds).findIndex(targetDir => targetDir === dir) === -1) {\n\t\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\t\tthis.excludeDirectoriesPaths.push(dir)\n\t\t\t\t\t\t\t\tthis.excludeFileIds[fileid.toString()] = dir\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\trequestFileInfo('/').then(res => {\n\t\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\t\tthis.excludeDirectoriesPaths.push(dir)\n\t\t\t\t\t\t\t\tthis.excludeFileIds[fileid.toString()] = '/'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already excluded'))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\trunCollectorTask() {\n\t\t\tthis.runningTask = true\n\t\t\tthis.runTask({\n\t\t\t\ttargetDirectoryIds: JSON.stringify(this.targetDirectoriesIds),\n\t\t\t\texcludeList: {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\tmask: this.customExcludeList,\n\t\t\t\t\t\tfileid: Object.keys(this.excludeFileIds).map(item => Number(item)),\n\t\t\t\t\t},\n\t\t\t\t\tadmin: JSON.parse(this.settingByName('exclude_list').value) || { mask: [], fileid: [] },\n\t\t\t\t},\n\t\t\t\tcollectorSettings: {\n\t\t\t\t\thashing_algorithm: JSON.parse(this.settingByName('hashing_algorithm').value) || 'dhash',\n\t\t\t\t\tsimilarity_threshold: this.similarity_threshold,\n\t\t\t\t\thash_size: this.settingByName('hash_size').value || 16,\n\t\t\t\t\ttarget_mtype: this.targetMimeType,\n\t\t\t\t\tfinish_notification: this.finishNotification,\n\t\t\t\t\texif_transpose: !JSON.parse(this.settingByName('ignore_orientation').value),\n\t\t\t\t},\n\t\t\t\tname: this.taskName,\n\t\t\t}).then(res => {\n\t\t\t\tthis.runningTask = false\n\t\t\t\tif (res.data.success) {\n\t\t\t\t\tthis.getTasks()\n\t\t\t\t\tthis.resetForm()\n\t\t\t\t\tshowSuccess(this.t('mediadc', 'New task successfully created!'))\n\t\t\t\t} else if (res.data.limit) {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'Running tasks limit exceed. Try again later.'))\n\t\t\t\t} else if (res.data.empty) {\n\t\t\t\t\tshowWarning(this.n('mediadc', 'Target folder has no files or all of them excluded', 'Target folders have no files or all of them excluded', this.targetDirectoriesIds.length))\n\t\t\t\t} else if (res.data.php_exec_not_enabled) {\n\t\t\t\t\tshowError(t('mediadc', 'Task run error: PHP `exec` function is not enabled'))\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(t('medaidc', 'Some error occurred while running Collector Task. Try again.'))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tremoveTargetDirectory(fileid) {\n\t\t\tdelete this.targetDirectoriesPaths[fileid]\n\t\t\tconst fileidIndex = this.targetDirectoriesIds.findIndex(id => id === fileid)\n\t\t\tthis.targetDirectoriesIds.splice(fileidIndex, 1)\n\t\t},\n\t\tremoveExcludeDirectory(fileid) {\n\t\t\tif (fileid in this.excludeFileIds) {\n\t\t\t\tconst dirIndex = this.excludeDirectoriesPaths.findIndex(dir => dir === this.excludeFileIds[fileid])\n\t\t\t\tthis.excludeDirectoriesPaths.splice(dirIndex, 1)\n\t\t\t\tdelete this.excludeFileIds[fileid]\n\t\t\t}\n\t\t},\n\t\taddNewMask() {\n\t\t\tthis.addingCustomMask = true\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$refs.customExcludeMask.focus()\n\t\t\t}, 100)\n\t\t},\n\t\taddCustomMask() {\n\t\t\tif (this.customExcludeMask.length > 0) {\n\t\t\t\tif (this.customExcludeList.findIndex(mask => mask === this.customExcludeMask) === -1) {\n\t\t\t\t\tthis.customExcludeList.push(this.customExcludeMask)\n\t\t\t\t\tthis.customExcludeMask = ''\n\t\t\t\t\tthis.addingCustomMask = false\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'This mask already exists!'))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(this.t('mediadc', 'Enter custom mask!'))\n\t\t\t}\n\t\t},\n\t\tcancelAddingCustomMask() {\n\t\t\tthis.customExcludeMask = ''\n\t\t\tthis.addingCustomMask = false\n\t\t},\n\t\tdeleteCustomMask(mask) {\n\t\t\tconst maskIndex = this.customExcludeList.findIndex(m => m === mask)\n\t\t\tthis.customExcludeList.splice(maskIndex, 1)\n\t\t},\n\t\tresetForm() {\n\t\t\tthis.targetDirectoriesPaths = {}\n\t\t\tthis.targetDirectoriesIds = []\n\t\t\tthis.excludeDirectoriesPaths = []\n\t\t\tthis.excludeFileIds = {}\n\t\t\tthis.targetMimeType = 0\n\t\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t\t: 90\n\t\t\tthis.customExcludeList = []\n\t\t\tthis.runningTask = false\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.new-task-block {\n\tborder: 1px solid var(--color-border-dark);\n\tborder-radius: var(--border-radius-large);\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px 20px 10px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\n\nbody[data-theme-dark] .new-task-block {\n\tborder-color: var(--color-border-dark);\n}\n\n@media (max-width: 767px) {\n\t.selection-container {\n\t\tflex-wrap: wrap;\n\t}\n}\n\n.create-task-actions {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 5px;\n\tpadding: 0 10px;\n}\n\n@media (max-width: 480px) {\n\t.create-task-actions {\n\t\tflex-direction: column;\n\t}\n\n\t.create-task-actions button {\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},31363:(t,e,n)=>{n.d(e,{A:()=>o});var i=n(71354),s=n.n(i),a=n(76314),r=n.n(a)()(s());r.push([t.id,"\n.container[data-v-fbfb9e52] {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\nh2[data-v-fbfb9e52] {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\np[data-v-fbfb9e52] {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n.mediadc-row[data-v-fbfb9e52] {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n@media (max-width: 960px) {\n.mediadc-row[data-v-fbfb9e52] {\n\t\tflex-wrap: wrap;\n}\n}\n","",{version:3,sources:["webpack://./src/views/Collector.vue"],names:[],mappings:";AAoGA;CACA,eAAA;CACA,WAAA;CACA,iBAAA;CACA,cAAA;AACA;AAEA;CACA,eAAA;CACA,iBAAA;CACA,kBAAA;CACA,mBAAA;AACA;AAEA;CACA,eAAA;CACA,cAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,uBAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021-2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021-2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2021-2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div v-if=\"!loading\" class=\"container\">\n\t\t<div class=\"heading\">\n\t\t\t<h2>{{ rootTitle }}</h2>\n\t\t\t<p>\n\t\t\t\t{{ t('mediadc', 'Welcome to Media Duplicate Collector (MediaDC). ') }}\n\t\t\t\t{{ t('mediadc', 'Here you can manage your duplicate collection tasks and see the history of previous finished tasks.') }}\n\t\t\t</p>\n\t\t</div>\n\t\t<div class=\"mediadc-row\">\n\t\t\t<TasksNew />\n\t\t\t<TasksList />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport TasksNew from '../components/tasks/TasksNew.vue'\nimport TasksList from '../components/tasks/TasksList.vue'\nimport { loadState } from '@nextcloud/initial-state'\nimport { mapActions } from 'vuex'\n\nexport default {\n\tname: 'Collector',\n\tcomponents: {\n\t\tTasksNew,\n\t\tTasksList,\n\t},\n\tprops: {\n\t\trootTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tupdating: false,\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tif (this.getTasks().length > 0) {\n\t\t\tthis.$emit('update:loading', false)\n\t\t} else {\n\t\t\tconst tasks = loadState('mediadc', 'tasks', false)\n\t\t\tconst settings = loadState('mediadc', 'settings', false)\n\t\t\tif (tasks) {\n\t\t\t\tthis.$store.commit('setTasks', tasks)\n\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t\tif (settings) {\n\t\t\t\t\tthis.$store.commit('setSettings', settings)\n\t\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t\t} else {\n\t\t\t\t\tthis.$store.dispatch('getSettings').then(() => {\n\t\t\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.$store.dispatch('getTasks', true).then(() => {\n\t\t\t\t\tthis.$store.dispatch('getSettings').then(() => {\n\t\t\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(['getTasks', 'getSettings']),\n\t},\n}\n<\/script>\n\n<style scoped>\n.container {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\n\nh2 {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\n\np {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n\n.mediadc-row {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n@media (max-width: 960px) {\n\t.mediadc-row {\n\t\tflex-wrap: wrap;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},74716:(t,e,n)=>{n.d(e,{A:()=>s});const i={name:"ClipboardListOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const s=(0,n(14486).A)(i,(function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon clipboard-list-outline-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19 3H14.82C14.4 1.84 13.3 1 12 1S9.6 1.84 9.18 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M12 3C12.55 3 13 3.45 13 4S12.55 5 12 5 11 4.55 11 4 11.45 3 12 3M7 7H17V5H19V19H5V5H7V7M12 17V15H17V17H12M12 11V9H17V11H12M8 12V9H7V8H9V12H8M9.25 14C9.66 14 10 14.34 10 14.75C10 14.95 9.92 15.14 9.79 15.27L8.12 17H10V18H7V17.08L9 15H7V14H9.25"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports},670:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(53357),s=n(6584);const a=(0,n(14486).A)(s.A,i.X,i.Y,!1,null,null,null).exports},55219:(t,e,n)=>{n.d(e,{A:()=>i});const i={name:"ContentCopyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}}},60017:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(81745),s=n(45519);const a=(0,n(14486).A)(s.A,i.X,i.Y,!1,null,null,null).exports},84440:(t,e,n)=>{n.d(e,{A:()=>i});const i={name:"PlusThickIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}}},43296:(e,n,i)=>{i.r(n),i.d(n,{default:()=>U});var s=i(85168),a=i(95353),r=i(60508),o=i(76333),l=i(60017);const c={name:"TasksNew",components:{NcButton:o.x1,NcCheckboxRadioSwitch:o.AO,PlusThick:l.A},data:()=>({targetDirectoriesPaths:{},targetDirectoriesIds:[],excludeDirectoriesPaths:[],excludeFileIds:{},targetMimeType:0,similarity_threshold:90,customExcludeList:[],customExcludeMask:"",addingCustomMask:!1,runningTask:!1,finishNotification:!0,taskName:""}),computed:{...(0,a.L8)(["settings","settingByName","tasks"])},beforeMount(){this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90},methods:{...(0,a.i0)(["runTask","getTasks"]),getDirectoriesPicker:t=>(0,s.a1)(t).setMultiSelect(!1).addMimeTypeFilter("httpd/unix-directory").setType(1).allowDirectories(!0).build(),openDirectoriesExplorer(){this.getDirectoriesPicker(this.t("mediadc","Choose target directory")).pick().then((t=>{t.startsWith("/")?(0,r.EF)(t).then((e=>{const n=(0,r.CK)(e.data);-1!==n&&(n in this.targetDirectoriesPaths?(0,s.I9)(this.t("mediadc","This directory already selected")):(this.targetDirectoriesIds.push(n),this.targetDirectoriesPaths[n.toString()]=t))})):(0,r.EF)("/").then((t=>{const e=(0,r.CK)(t.data);-1!==e&&(e in this.targetDirectoriesPaths?(0,s.I9)(this.t("mediadc","This directory already selected")):(this.targetDirectoriesIds.push(e),this.targetDirectoriesPaths[e.toString()]="/"))}))}))},openExcludeExplorer(){this.getDirectoriesPicker(this.t("mediadc","Choose directory to exclude")).pick().then((t=>{-1===Object.values(this.excludeFileIds).findIndex((e=>e===t))?t.startsWith("/")?(0,r.EF)(t).then((e=>{const n=(0,r.CK)(e.data);-1!==n&&(this.excludeDirectoriesPaths.push(t),this.excludeFileIds[n.toString()]=t)})):(0,r.EF)("/").then((e=>{const n=(0,r.CK)(e.data);-1!==n&&(this.excludeDirectoriesPaths.push(t),this.excludeFileIds[n.toString()]="/")})):(0,s.I9)(this.t("mediadc","This directory already excluded"))}))},runCollectorTask(){this.runningTask=!0,this.runTask({targetDirectoryIds:JSON.stringify(this.targetDirectoriesIds),excludeList:{user:{mask:this.customExcludeList,fileid:Object.keys(this.excludeFileIds).map((t=>Number(t)))},admin:JSON.parse(this.settingByName("exclude_list").value)||{mask:[],fileid:[]}},collectorSettings:{hashing_algorithm:JSON.parse(this.settingByName("hashing_algorithm").value)||"dhash",similarity_threshold:this.similarity_threshold,hash_size:this.settingByName("hash_size").value||16,target_mtype:this.targetMimeType,finish_notification:this.finishNotification,exif_transpose:!JSON.parse(this.settingByName("ignore_orientation").value)},name:this.taskName}).then((e=>{this.runningTask=!1,e.data.success?(this.getTasks(),this.resetForm(),(0,s.Te)(this.t("mediadc","New task successfully created!"))):e.data.limit?(0,s.I9)(this.t("mediadc","Running tasks limit exceed. Try again later.")):e.data.empty?(0,s.I9)(this.n("mediadc","Target folder has no files or all of them excluded","Target folders have no files or all of them excluded",this.targetDirectoriesIds.length)):e.data.php_exec_not_enabled?(0,s.Qg)(t("mediadc","Task run error: PHP `exec` function is not enabled")):(0,s.I9)(t("medaidc","Some error occurred while running Collector Task. Try again."))}))},removeTargetDirectory(t){delete this.targetDirectoriesPaths[t];const e=this.targetDirectoriesIds.findIndex((e=>e===t));this.targetDirectoriesIds.splice(e,1)},removeExcludeDirectory(t){if(t in this.excludeFileIds){const e=this.excludeDirectoriesPaths.findIndex((e=>e===this.excludeFileIds[t]));this.excludeDirectoriesPaths.splice(e,1),delete this.excludeFileIds[t]}},addNewMask(){this.addingCustomMask=!0,setTimeout((()=>{this.$refs.customExcludeMask.focus()}),100)},addCustomMask(){this.customExcludeMask.length>0?-1===this.customExcludeList.findIndex((t=>t===this.customExcludeMask))?(this.customExcludeList.push(this.customExcludeMask),this.customExcludeMask="",this.addingCustomMask=!1):(0,s.I9)(this.t("mediadc","This mask already exists!")):(0,s.I9)(this.t("mediadc","Enter custom mask!"))},cancelAddingCustomMask(){this.customExcludeMask="",this.addingCustomMask=!1},deleteCustomMask(t){const e=this.customExcludeList.findIndex((e=>e===t));this.customExcludeList.splice(e,1)},resetForm(){this.targetDirectoriesPaths={},this.targetDirectoriesIds=[],this.excludeDirectoriesPaths=[],this.excludeFileIds={},this.targetMimeType=0,this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90,this.customExcludeList=[],this.runningTask=!1}}};var d=i(85072),m=i.n(d),u=i(97825),p=i.n(u),h=i(77659),A=i.n(h),k=i(55056),g=i.n(k),f=i(10540),y=i.n(f),v=i(41113),x=i.n(v),C=i(65390),b={};b.styleTagTransform=x(),b.setAttributes=g(),b.insert=A().bind(null,"head"),b.domAPI=p(),b.insertStyleElement=y();m()(C.A,b);C.A&&C.A.locals&&C.A.locals;var _=i(14486);const T=(0,_.A)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"new-task-block"},[e("h2",[t._v(t._s(t.t("mediadc","Create a new Task")))]),t._v(" "),e("div",{staticClass:"selection-container"},[e("div",{staticClass:"block target-directories-block"},[e("h3",[t._v(t._s(t.t("mediadc","Target directories")))]),t._v(" "),t.targetDirectoriesIds.length>0?e("div",t._l(t.targetDirectoriesIds,(function(n){return e("div",{key:n,staticClass:"selected-target-directories-list"},[e("div",{staticClass:"target-directory"},[e("span",{staticStyle:{"overflow-y":"scroll","white-space":"nowrap"},attrs:{title:t.targetDirectoriesPaths[n]}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.targetDirectoriesPaths[n])+"\n\t\t\t\t\t\t")]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected target directory")},on:{click:function(e){return t.removeTargetDirectory(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)])})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),e("br"),t._v(" "),e("NcButton",{attrs:{"aria-label":t.t("mediadc","Select target directory")},on:{click:t.openDirectoriesExplorer},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])],1),t._v(" "),e("div",{staticClass:"block"},[e("h3",[t._v(t._s(t.t("mediadc","Exclude directories")))]),t._v(" "),t.excludeDirectoriesPaths.length>0?e("div",t._l(Object.keys(t.excludeFileIds),(function(n){return e("div",{key:n,staticClass:"selected-excluded-directories-list"},[e("div",{staticClass:"target-directory"},[e("span",{staticStyle:{"overflow-y":"scroll","white-space":"nowrap"},attrs:{title:t.excludeFileIds[n]}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.excludeFileIds[n])+"\n\t\t\t\t\t\t")]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected exclude directory")},on:{click:function(e){return t.removeExcludeDirectory(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)])})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),e("br"),t._v(" "),e("NcButton",{attrs:{"aria-label":t.t("mediadc","Select exclude directory")},on:{click:t.openExcludeExplorer},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])],1)]),t._v(" "),e("div",{staticClass:"selection-container"},[e("div",{staticClass:"block"},[e("h3",[t._v(t._s(t.t("mediadc","Custom exclude mask")))]),t._v(" "),t.customExcludeList.length>0?e("div",{staticClass:"custom-masks-list"},t._l(t.customExcludeList,(function(n,i){return e("div",{key:i,staticClass:"custom-mask"},[e("span",[t._v(t._s(n))]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected custom exclude mask")},on:{click:function(e){return t.deleteCustomMask(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not added")))])]),t._v(" "),t.addingCustomMask?e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.customExcludeMask,expression:"customExcludeMask"}],ref:"customExcludeMask",attrs:{id:"custom-exclude-mask",type:"text"},domProps:{value:t.customExcludeMask},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addCustomMask.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancelAddingCustomMask.apply(null,arguments)}],input:function(e){e.target.composing||(t.customExcludeMask=e.target.value)}}}),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Confirm"),expression:"t('mediadc', 'Confirm')"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Confirm adding of the custom exclude mask")},on:{click:t.addCustomMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-checkmark"})]},proxy:!0}],null,!1,3443818620)}),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Decline"),expression:"t('mediadc', 'Decline')"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Cancel adding of the custom exclude mask")},on:{click:t.cancelAddingCustomMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-close"})]},proxy:!0}],null,!1,1218614841)})],1):t._e(),t._v(" "),e("div",{staticStyle:{display:"flex","align-items":"center",margin:"20px 0"}},[e("NcButton",{attrs:{"aria-label":t.t("mediadc","Add custom exclude mask")},on:{click:t.addNewMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0},{key:"default",fn:function(){return[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mediadc","Add mask"))+"\n\t\t\t\t\t")]},proxy:!0}])})],1)]),t._v(" "),e("div",{staticClass:"block"},[e("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Target Mime Type"))+"\n\t\t\t")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.targetMimeType,expression:"targetMimeType"}],attrs:{id:"target_mtype",name:"target_mtype"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.targetMimeType=e.target.multiple?n:n[0]}}},[e("option",{domProps:{value:0}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos"))+"\n\t\t\t\t")]),t._v(" "),e("option",{domProps:{value:1}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Videos"))+"\n\t\t\t\t")]),t._v(" "),e("option",{domProps:{value:2}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos and Videos"))+"\n\t\t\t\t")])]),t._v(" "),e("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Similarity threshold"))+"\n\t\t\t")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.similarity_threshold,expression:"similarity_threshold"}],staticStyle:{margin:"0 0 10px"},attrs:{type:"number",min:"50",max:"100"},domProps:{value:t.similarity_threshold},on:{input:function(e){e.target.composing||(t.similarity_threshold=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"create-task-actions"},[e("NcButton",{attrs:{"aria-label":t.t("mediadc","Create and Run new Task"),disabled:t.runningTask||0===Object.keys(t.targetDirectoriesPaths).length},on:{click:t.runCollectorTask},scopedSlots:t._u([{key:"default",fn:function(){return[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Run new Task"))+"\n\t\t\t")]},proxy:!0},t.runningTask?{key:"icon",fn:function(){return[e("span",{staticClass:"icon-loading-small"})]},proxy:!0}:null],null,!0)}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.taskName,expression:"taskName"}],attrs:{type:"text",placeholder:t.t("mediadc","Task name")},domProps:{value:t.taskName},on:{input:function(e){e.target.composing||(t.taskName=e.target.value)}}}),t._v(" "),e("NcCheckboxRadioSwitch",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Send notification on task finish"),expression:"t('mediadc', 'Send notification on task finish')"}],attrs:{checked:t.finishNotification},on:{"update:checked":function(e){t.finishNotification=e}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Finish notification"))+"\n\t\t")])],1)])}),[],!1,null,"0e7940d3",null).exports;var N=i(74716),w=i(56920),I=i(670);const B={name:"TasksListItem",components:{NcActionButton:o.Ko,ContentCopy:I.A,NcListItem:o.l,NcProgressBar:o.kS},mixins:[w.A],props:{task:{type:Object,required:!0}},computed:{...(0,a.L8)(["tasks"]),listItemTitle(){return`${""!==this.task.name&&null!==this.task.name?this.task.name+" - ":""}${this.parseTargetMtype(this.task)}\n\t\t\t\t${this.task.files_scanned!==this.task.files_total?this.task.files_scanned+"/":""}${this.task.files_total} ${this.n("mediadc","file","files",this.task.files_total)}\n\t\t\t\t(${this.formatBytes(Number(this.task.files_total_size))})`},listItemDetails(){return`${this.parseUnixTimestamp(this.task.created_time)}\n\t\t\t\t${Number(this.task.finished_time)>0?" - "+this.parseUnixTimestamp(this.task.finished_time):""}`}},methods:{...(0,a.i0)(["getTasks","getSettings","deleteTask","duplicateTask","terminateTask","restartTask"])}};var S=i(91806),E={};E.styleTagTransform=x(),E.setAttributes=g(),E.insert=A().bind(null,"head"),E.domAPI=p(),E.insertStyleElement=y();m()(S.A,E);S.A&&S.A.locals&&S.A.locals;var P=i(49394),D={};D.styleTagTransform=x(),D.setAttributes=g(),D.insert=A().bind(null,"head"),D.domAPI=p(),D.insertStyleElement=y();m()(P.A,D);P.A&&P.A.locals&&P.A.locals;const M={name:"TasksList",components:{TasksListItem:(0,_.A)(B,(function(){var t=this,e=t._self._c;return e("NcListItem",{staticClass:"task-list-item",attrs:{name:t.listItemTitle,bold:!0,"force-display-actions":!0,to:{name:"collectorDetails",params:{taskId:t.task.id}}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{class:"badge "+t.getStatusBadge(t.task)},[t._v(t._s(t.getStatusBadge(t.task)))])]},proxy:!0},{key:"subname",fn:function(){return[t._v("\n\t\t"+t._s(t.listItemDetails)+"\n\t\t"),e("NcProgressBar",{attrs:{value:Math.round(t.task.files_scanned/t.task.files_total*100),size:"small",error:"error"===t.getStatusBadge(t.task)}})]},proxy:!0},{key:"actions",fn:function(){return[e("NcActionButton",{attrs:{icon:"icon-history","close-after-click":!0},on:{click:function(e){return t.restartTask(t.task)}}},[t._v("\n\t\t\t"+t._s("duplicated"===t.getStatusBadge(t.task)?t.t("mediadc","Start"):t.t("mediadc","Restart"))+"\n\t\t")]),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-pause","close-after-click":!0},on:{click:function(e){return t.terminateTask(t.task)}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Stop"))+"\n\t\t")]),t._v(" "),e("NcActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Create copy of the task"),placement:"left"},expression:"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}"}],attrs:{"close-after-click":!0},on:{click:function(e){return t.duplicateTask(t.task)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ContentCopy",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Duplicate"))+"\n\t\t\t")]),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-delete","close-after-click":!0},on:{click:function(e){return t.deleteTask(t.task)}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Delete"))+"\n\t\t")])]},proxy:!0}])})}),[],!1,null,"6c910423",null).exports,NcEmptyContent:o.yI,ClipboardListOutline:N.A},mixins:[w.A],data:()=>({tasksUpdater:null}),computed:{...(0,a.L8)(["tasks"])},beforeMount(){this.tasksUpdater=setInterval((()=>this.getTasks(!0)),5e3)},beforeDestroy(){clearInterval(this.tasksUpdater)},methods:{...(0,a.i0)(["getTasks"])}};var L=i(14434),F={};F.styleTagTransform=x(),F.setAttributes=g(),F.insert=A().bind(null,"head"),F.domAPI=p(),F.insertStyleElement=y();m()(L.A,F);L.A&&L.A.locals&&L.A.locals;const R=(0,_.A)(M,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tasks-list"},[e("h2",[t._v(t._s(t.t("mediadc","Recent Tasks")))]),t._v(" "),t.tasks.length>0?e("div",[e("transition-group",{attrs:{name:"list",tag:"ul"}},t._l(t.tasks,(function(t){return e("TasksListItem",{key:t.id,staticClass:"task-row",attrs:{task:t}})})),1)],1):e("div",{staticClass:"empty-tasks-list"},[e("NcEmptyContent",{staticStyle:{"margin-top":"5vh"},attrs:{name:t.t("mediadc","No tasks yet"),description:t.t("mediadc","Create a new one!")},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ClipboardListOutline")]},proxy:!0}])})],1)])}),[],!1,null,"036192ef",null).exports;var $=i(32981);const H={name:"Collector",components:{TasksNew:T,TasksList:R},props:{rootTitle:{type:String,required:!0},loading:{type:Boolean,required:!0}},data:()=>({updating:!1}),beforeMount(){if(this.getTasks().length>0)this.$emit("update:loading",!1);else{const t=(0,$.C)("mediadc","tasks",!1),e=(0,$.C)("mediadc","settings",!1);t?(this.$store.commit("setTasks",t),this.$emit("update:loading",!1),e?(this.$store.commit("setSettings",e),this.$emit("update:loading",!1)):this.$store.dispatch("getSettings").then((()=>{this.$emit("update:loading",!1)}))):this.$store.dispatch("getTasks",!0).then((()=>{this.$store.dispatch("getSettings").then((()=>{this.$emit("update:loading",!1)}))}))}},methods:{...(0,a.i0)(["getTasks","getSettings"])}};var G=i(31363),O={};O.styleTagTransform=x(),O.setAttributes=g(),O.insert=A().bind(null,"head"),O.domAPI=p(),O.insertStyleElement=y();m()(G.A,O);G.A&&G.A.locals&&G.A.locals;const U=(0,_.A)(H,(function(){var t=this,e=t._self._c;return t.loading?t._e():e("div",{staticClass:"container"},[e("div",{staticClass:"heading"},[e("h2",[t._v(t._s(t.rootTitle))]),t._v(" "),e("p",[t._v("\n\t\t\t"+t._s(t.t("mediadc","Welcome to Media Duplicate Collector (MediaDC). "))+"\n\t\t\t"+t._s(t.t("mediadc","Here you can manage your duplicate collection tasks and see the history of previous finished tasks."))+"\n\t\t")])]),t._v(" "),e("div",{staticClass:"mediadc-row"},[e("TasksNew"),t._v(" "),e("TasksList")],1)])}),[],!1,null,"fbfb9e52",null).exports},6584:(t,e,n)=>{n.d(e,{A:()=>i});const i=n(55219).A},45519:(t,e,n)=>{n.d(e,{A:()=>i});const i=n(84440).A},53357:(t,e,n)=>{n.d(e,{X:()=>i,Y:()=>s});var i=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon content-copy-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},s=[]},81745:(t,e,n)=>{n.d(e,{X:()=>i,Y:()=>s});var i=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon plus-thick-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M20 14H14V20H10V14H4V10H10V4H14V10H20V14Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},s=[]}}]);
//# sourceMappingURL=mediadc-src_views_Collector_vue.js.map?v=e99c37958485ea92c4fd